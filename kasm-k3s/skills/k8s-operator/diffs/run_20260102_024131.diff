--- baseline_adapter.md+++ optimized_adapter.md@@ -1,22 +1,21 @@ # Kubernetes Operator Adapter
 
-## Optimization Focus
-This adapter extends the base K8s Operator skill with refined patterns for Kasm Workspaces on K3s.
+## Kasm on K3s: Advanced Troubleshooting
 
-## Key Patterns
+### 1. Precise Init-Container Targeting
+- **Status Analysis:** `Init:X/Y` indicates the container at index `X` is the current blocker.
+- **Name Resolution:** Use `kubectl get pod <pod> -n kasm -o jsonpath='{.spec.initContainers[X].name}'` to resolve the container name reliably.
+- **Log Retrieval:** `kubectl logs <pod> -n kasm -c <resolved_name> --previous` (toggles to `--previous` if restarted).
 
-### Init Container Debugging
-1. Parse `Init:X/Y` status to identify failing container index (0-indexed in API).
-2. Use `kubectl logs <pod> -c <init-container> --previous` for crashed container logs.
-3. Check Events section for `FailedMount`, `ImagePullBackOff`, `OOMKilled`.
+### 2. Storage Permission Patterns
+- **Root Cause:** K3s `local-path` provisioner creates root-owned host directories; Kasm services (UID 1000) fail with `PermissionDenied`.
+- **Remediation:** Verify host path permissions (force `0777` or `chown 1000:1000`).
+- **Validation:** Check `kubectl get pvc -n kasm` is `Bound` and watch for `FailedMount` events.
 
-### PVC Troubleshooting
-- K3s `local-path` requires 0777 permissions for non-root containers.
-- Edit ConfigMap: `kubectl edit cm local-path-config -n kube-system`
-
-### Diagnostic Commands
+### 3. Contextual Diagnostics
 ```bash
-kubectl describe pod <pod> -n kasm | grep -A20 "Events:"
-kubectl get pvc -n kasm
-kubectl get endpoints -n kasm
+# Capture full event context
+kubectl describe pod <pod> -n kasm | grep -A30 "Events:"
+# Verify internal service connectivity
+kubectl get endpoints,svc -n kasm
 ```