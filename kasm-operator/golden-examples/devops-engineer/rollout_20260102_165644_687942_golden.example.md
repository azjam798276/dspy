---
id: "rollout_20260102_165644_687942_golden"
generated_at: "2026-01-02T17:04:39.596151"
tags: ["devops-engineer", "auto-generated"]
---

## Problem
---
id: "20260102_helm_chart"
difficulty: "hard"
tags: ["devops", "helm", "kubernetes", "deployment", "operator"]
tech_stack: "Helm 3, Kubernetes, Go"
---

# User Story
As a DevOps engineer, I want a Helm chart for the VDI Operator, so I can deploy and configure the platform with a single command.

# Context & Constraints
**Chart Structure:**
```
charts/vdi-operator/
├── Chart.yaml
├── values.yaml
├── templates/
│   ├── deployment.yaml
│   ├── rbac.yaml
│   ├── crds/
│   │   ├── vdisession-crd.yaml
│   │   └── vditemplate-crd.yaml
│   ├── configmap.yaml
│   ├── service.yaml
│   └── servicemonitor.yaml
└── charts/
    └── coturn/
```

**values.yaml:**
```yaml
operator:
  image:
    repository: ghcr.io/org/vdi-operator
    tag: v0.1.0
  replicas: 1

selkies:
  image: ghcr.io/selkies-project/

## Solution
{
  "session_id": "adbcfffb-2066-4905-a7cf-efcd380fca79",
  "response": "```json\n{\n  \"reasoning\": \"I have designed the Helm chart to meet the DevOps engineer's requirements for a single-command deployment. \\n\\n1. **Chart Structure**: I created the standard Helm directory layout with `Chart.yaml`, `values.yaml`, and `templates/`. I included the `crds/` folder for the Custom Resource Definitions.\\n2. **Configuration**: The `values.yaml` file exposes key parameters like image repository/tag, replica count, default resources, and Ingress domain, fulfilling the 'Configurable' acceptance criteria.\\n3. **CRDs**: I extracted the `VDISession` and `VDITemplate` schemas directly from `docs/TDD.md` and placed them in `templates/crds/`. This ensures the operator has the custom resources it needs to manage.\\n4. **Security & RBAC**: I implemented the `ClusterRole` based on the Security Engineer's hardened specifications, strictly limiting verbs and resources. I added read access to `vditemplates` which is required for the operator to function but was implicit in the security doc.\\n5. **Observability**: I included a `Service` and `ServiceMonitor` to expose the operator's metrics to Prometheus, satisfying the observability requirement.\",\n  \"files\": [\n    {\n      \"path\": \"charts/vdi-operator/Chart.yaml\",\n      \"content\": \"apiVersion: v2\\nname: vdi-operator\\ndescription: A Helm chart for the Kasm VDI Operator\\ntype: application\\nversion: 0.1.0\\nappVersion: \\\"0.1.0\\\"\\nkeywords:\\n  - vdi\\n  - operator\\n  - kasm\\nmaintainers:\\n  - name: devops-engineer\\n\"\n    },\n    {\n      \"path\": \"charts/vdi-operator/values.yaml\",\n      \"content\": \"operator:\\n  image:\\n    repository: ghcr.io/org/vdi-operator\\n    tag: v0.1.0\\n    pullPolicy: IfNotPresent\\n  replicas: 1\\n  resources:\\n    limits:\\n      cpu: 200m\\n      memory: 256Mi\\n    requests:\\n      cpu: 100m\\n      memory: 128Mi\\n\\nselkies:\\n  image: ghcr.io/selkies-project/selkies-gstreamer/gst-web:latest\\n  defaultResources:\\n    gpu: 1\\n    memory: 4Gi\\n\\ningress:\\n  enabled: true\\n  className: traefik\\n  domain: vdi.example.com\\n\"\n    },\n    {\n      \"path\": \"charts/vdi-operator/templates/crds/vdisession-crd.yaml\",\n      \"content\": \"apiVersion: apiextensions.k8s.io/v1\\nkind: CustomResourceDefinition\\nmetadata:\\n  name: vdisessions.vdi.kasm.io\\n  annotations:\\n    controller-gen.kubebuilder.io/version: v0.11.1\\nspec:\\n  group: vdi.kasm.io\\n  versions:\\n    - name: v1alpha1\\n      served: true\\n      storage: true\\n      schema:\\n        openAPIV3Schema:\\n          type: object\\n          properties:\\n            spec:\\n              type: object\\n              required: [user, template]\\n              properties:\\n                user:\\n                  type: string\\n                  description: User email or ID\\n                template:\\n                  type: string\\n                  description: Referen

## Key Techniques
- JWT token handling
- Input validation
