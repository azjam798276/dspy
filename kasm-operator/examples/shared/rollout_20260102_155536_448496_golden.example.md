---
id: "rollout_20260102_155536_448496_golden"
generated_at: "2026-01-02T16:03:02.795824"
tags: ["shared", "auto-generated"]
---

## Problem
---
id: "20260102_selkies_pod_template"
difficulty: "medium"
tags: ["webrtc", "selkies", "gstreamer", "nvenc", "pod"]
tech_stack: "GStreamer, NVENC, WebRTC, Kubernetes"
---

# User Story
As a streaming engineer, I want a Selkies-GStreamer pod template with optimal WebRTC settings, so users get low-latency GPU-accelerated desktop streaming.

# Context & Constraints
**Pod Configuration:**
```yaml
containers:
  - name: selkies
    image: ghcr.io/selkies-project/selkies-gstreamer/gst-web:latest
    env:
      - name: SELKIES_ENCODER
        value: "nvh264enc"
      - name: SELKIES_ENABLE_RESIZE
        value: "true"
      - name: DISPLAY
        value: ":0"
    resources:
      limits:
        nvidia.com/gpu: "1"
        memory: "4Gi"
    ports:
      - containerPort: 8080
        name: http
`

## Solution
{
  "session_id": "213e0474-51bb-4036-b127-8f6d537aa739",
  "response": "```json\n{\n  \"reasoning\": \"I have created an optimized Selkies-GStreamer pod template for Phase 0 validation, incorporating all the specified requirements for high-performance WebRTC streaming. The template explicitly requests 'nvidia.com/gpu: 1' to align with the platform's multi-tenant GPU time-slicing strategy and enforces 'SELKIES_ENCODER=nvh264enc' to utilize NVIDIA's hardware encoder for ultra-low latency. Critical performance optimizations include a memory-backed /dev/shm volume for X11/GStreamer frame buffering and a /dev/dri hostPath mount to enable hardware-accelerated rendering within the desktop. I have also included a README to document the CPU fallback strategy (x264enc) for environments where physical GPUs are unavailable.\",\n  \"code_patch\": \"--- /dev/null\\n+++ manifests/phase-0/selkies-pod.yaml\\n@@ -0,0 +1,56 @@\\n+apiVersion: v1\\n+kind: Pod\\n+metadata:\\n+  name: selkies-vdi-validation\\n+  labels:\\n+    vdi.kasm.io/session-type: desktop\\n+spec:\\n+  containers:\\n+  - name: selkies\\n+    image: ghcr.io/selkies-project/selkies-gstreamer/gst-web:latest\\n+    env:\\n+    - name: SELKIES_ENCODER\\n+      value: \\\"nvh264enc\\\" # NVIDIA hardware encoding\\n+    - name: SELKIES_ENABLE_RESIZE\\n+      value: \\\"true\\\"\\n+    - name: DISPLAY\\n+      value: \\\":0\\\"\\n+    - name: SELKIES_BASIC_AUTH_PASSWORD\\n+      value: \\\"vdi-validation-pwd\\\" # Placeholder: Managed by operator in prod\\n+    - name: PULSE_SERVER\\n+      value: \\\"/run/pulse/native\\\"\\n+    resources:\\n+      limits:\\n+        nvidia.com/gpu: \\\"1\\\" # Time-slice allocation\\n+        memory: \\\"4Gi\\\"\\n+      requests:\\n+        nvidia.com/gpu: \\\"1\\\"\\n+        cpu: \\\"1\\\"\\n+    ports:\\n+    - containerPort: 8080\\n+      name: http\\n+    volumeMounts:\\n+    - name: home\\n+      mountPath: /home/user\\n+    - name: shm\\n+      mountPath: /dev/shm\\n+    - name: dri\\n+      mountPath: /dev/dri\\n+  volumes:\\n+  - name: home\\n+    persistentVolumeClaim:\\n+      claimName: selkies-home-pvc\\n+  - name: shm\\n+    emptyDir:\\n+      medium: Memory\\n+      sizeLimit: \\\"2Gi\\\"\\n+  - name: dri\\n+    hostPath:\\n+      path: /dev/dri\\n+--- /dev/null\\n++++ manifests/phase-0/README.md\\n+@@ -0,0 +1,11 @@\\n+# Phase 0: Validation Manifests\\n+\\n+## Selkies Pod Template\\n+\\n+This pod template is designed for low-latency WebRTC streaming using NVIDIA GPUs.\\n+\\n+### CPU Fallback\\n+If a GPU is not available or NVENC fails, change the `SELKIES_ENCODER` environment variable:\\n+```yaml\\n+- name: SELKIES_ENCODER\\n+  value: \\\"x264enc\\\"\\n+```\\n\"\n}\n```",
  "stats": {
    "models": {
      "gemini-2.5-flash-lite": {
        "api": {
          "totalRequests": 1,
          "totalErrors": 0,
          "totalLatencyMs": 2853
        },
        "tokens": {
          "input": 5877,
          "prompt": 5877,
          "candidates": 154,
     

## Key Techniques
- JWT token handling
