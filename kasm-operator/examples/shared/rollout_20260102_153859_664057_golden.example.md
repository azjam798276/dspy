---
id: "rollout_20260102_153859_664057_golden"
generated_at: "2026-01-02T16:03:02.818791"
tags: ["shared", "auto-generated"]
---

## Problem
---
id: "20260102_vditemplate_crd"
difficulty: "easy"
tags: ["kubernetes", "crd", "template", "kubebuilder"]
tech_stack: "Go 1.21, kubebuilder"
---

# User Story
As a platform admin, I want a VDITemplate CRD to define available desktop environments, so users can choose from pre-configured templates.

# Context & Constraints
**CRD Specification:**
```yaml
apiVersion: vdi.kasm.io/v1alpha1
kind: VDITemplate
metadata:
  name: ubuntu-desktop
spec:
  image: ghcr.io/selkies-project/selkies-gstreamer/gst-web:latest
  displayName: "Ubuntu 22.04 Desktop"
  description: "Full Ubuntu desktop with GPU acceleration"
  resources:
    defaultGPU: 1
    defaultMemory: "4Gi"
    defaultCPU: "2"
  env:
    - name: SELKIES_ENCODER
      value: "nvh264enc"
```

**Fields:**
| Field | Type | Description |
|-----

## Solution
{
  "session_id": "b54b7fd2-dc52-4782-916a-96f87d2c5a62",
  "response": "I will generate the necessary Go code for the `VDITemplate` CRD, including the `VDITemplateSpec` with all required fields, defaults, and validation markers, as well as the boilerplate `groupversion_info.go` and `go.mod` files, packaged as a JSON response.\n\n```json\n[\n  {\n    \"path\": \"operator/go.mod\",\n    \"content\": \"module github.com/user/vdi-operator\\n\\ngo 1.21\\n\\nrequire (\\n\\tk8s.io/apimachinery v0.28.0\\n\\tsigs.k8s.io/controller-runtime v0.16.0\\n)\\n\"\n  },\n  {\n    \"path\": \"operator/api/v1alpha1/groupversion_info.go\",\n    \"content\": \"// Package v1alpha1 contains API Schema definitions for the vdi v1alpha1 API group\\n// +kubebuilder:object:generate=true\\n// +groupName=vdi.kasm.io\\npackage v1alpha1\\n\\nimport (\\n\\t\\\"k8s.io/apimachinery/pkg/runtime/schema\\\"\\n\\t\\\"sigs.k8s.io/controller-runtime/pkg/scheme\\\"\\n)\\n\\nvar (\\n\\t// GroupVersion is group version used to register these objects\\n\\tGroupVersion = schema.GroupVersion{Group: \\\"vdi.kasm.io\\\", Version: \\\"v1alpha1\\\"}\\n\\n\\t// SchemeBuilder is used to add go types to the GroupVersionKind scheme\\n\\tSchemeBuilder = &scheme.Builder{GroupVersion: GroupVersion}\\n\\n\\t// AddToScheme adds the types in this group-version to the given scheme.\\n\\tAddToScheme = SchemeBuilder.AddToScheme\\n)\\n\"\n  },\n  {\n    \"path\": \"operator/api/v1alpha1/vditemplate_types.go\",\n    \"content\": \"package v1alpha1\\n\\nimport (\\n\\tmetav1 \\\"k8s.io/apimachinery/pkg/apis/meta/v1\\\"\\n)\\n\\n// VDITemplateSpec defines the desired state of VDITemplate\\ntype VDITemplateSpec struct {\\n\\t// Image is the container image to use for the session\\n\\t// +kubebuilder:validation:Required\\n\\tImage string `json:\\\"image\\\"`\\n\\n\\t// DisplayName is the human-readable name of the template\\n\\t// +optional\\n\\tDisplayName string `json:\\\"displayName,omitempty\\\"`\\n\\n\\t// Description is a brief description of the template\\n\\t// +optional\\n\\tDescription string `json:\\\"description,omitempty\\\"`\\n\\n\\t// Resources defines the default resource requirements\\n\\t// +optional\\n\\tResources ResourceSpec `json:\\\"resources,omitempty\\\"`\\n\\n\\t// Env defines environment variables to inject\\n\\t// +optional\\n\\tEnv []EnvVar `json:\\\"env,omitempty\\\"`\\n}\\n\\n// ResourceSpec defines resource requests and limits\\ntype ResourceSpec struct {\\n\\t// DefaultGPU is the number of GPU slices to allocate\\n\\t// +kubebuilder:default=1\\n\\t// +optional\\n\\tDefaultGPU int `json:\\\"defaultGPU,omitempty\\\"`\\n\\n\\t// DefaultMemory is the amount of memory to allocate (e.g. \\\"4Gi\\\")\\n\\t// +kubebuilder:default=\\\"4Gi\\\"\\n\\t// +optional\\n\\tDefaultMemory string `json:\\\"defaultMemory,omitempty\\\"`\\n\\n\\t// DefaultCPU is the amount of CPU to allocate (e.g. \\\"2\\\")\\n\\t// +kubebuilder:default=\\\"2\\\"\\n\\t// +optional\\n\\tDefaultCPU string `json:\\\"defaultCP

## Key Techniques
- JWT token handling
- Input validation
